<view class="container">
    <navigator hover-class="none" class="user" url="/pages/user/address/address?select=true">
        <block wx:if="{{props.order.address!=null}}">
            <view>
                <text class="username">{{props.order.address.name}}</text>
                <text class="'phone'">{{props.order.address.mobile}}</text>
            </view>
            <view class="address">
                <text>{{props.order.address.provincename}} {{props.order.address.cityname}} {{props.order.address.areaname}} {{props.order.address.address}}</text>
                <image class="_right" src="/static/icons/right.png" />
            </view>
            <image src="/static/icons/cart/line.png" class="line" />
        </block>
        <view wx:if="{{props.order.address==null}}">
            新增地址<image class="_right" src="/static/icons/right.png" />
        </view>
    </navigator>
    <view class="box">
        <view class="cart">
            <view class="item" wx:for="{{props.cart.list}}" wx:key="{{cartIndex}}" wx:for-index="cartIndex" wx:if="{{item.settle}}">
                <view class="header">
                    <view>
                        <image class="select-icon" src="{{item.shop.logo}}" />
                        {{item.shop.name}}
                    </view>
                    <image class="_right" src="/static/icons/right.png" />
                </view>
                <view>
                    <view class="goods {{state===0?'bfbfbfb':'bf9fefa'}}" wx:for="{{item.goods}}"
                          wx:key="{{goodsIndex}}" wx:for-item="goods"
                          wx:for-index="goodsIndex" wx:if="{{goods.selected}}">
                        <view class="thumbView">
                            <view class="shortage" wx:if="{{state===0}}">缺货</view>
                            <image class="thumb" src="{{goods.image}}" />
                        </view>
                        <view class="info">
                            <view class="title">{{goods.name}}</view>
                            <view class="unit">{{goods.unit}}</view>
                            <view class="price">
                                ￥{{goods.total}}
                                <view class="calc">
                                    <!-- <image src="/static/icons/cart/jian.png" class="op" bind:tap="reduce" data-goods-index="{{goodsIndex}}" data-cart-index="{{cartIndex}}" /> -->
                                    <text class="num">{{goods.count}}</text>
                                    <!-- <image src="/static/icons/cart/jia.png" class="op" bind:tap="increase" data-goods-index="{{goodsIndex}}" data-cart-index="{{cartIndex}}" /> -->
                                </view>
                            </view>
                        </view>
                    </view>
                </view>
                <view class="line">
                    <text>买家留言</text>
                    <input placeholder="选填，可填写您与卖家达成一致的要求" bindinput="onInput" data-mid="{{item.shop.id}}"/>
                </view>
            </view>
        </view>
        <view class="item">
            <view class="line">
                <text>运费</text>
                <text wx:if="{{logisticsprc>0}}">{{logisticsprc}}元</text>
                <text wx:if="{{logisticsprc==0}}">免运费</text>
            </view>
            <view class="line">
                <text>优惠券</text>
                <text wx:if="{{hasCoupon==0}}">暂无可用优惠券</text>
                <navigator hover-class="none" url="/pages/user/coupon/coupon?select=true&param={{couponParam}}" wx:if="{{hasCoupon>0}}">{{props.order.coupon==null?hasCoupon+'张优惠券可用':'-'+props.order.coupon.value}}</navigator>
            </view>
        </view>
    </view>
</view>
<view class="bottom-btn">
    <view class="all">
        <block wx:if="{{props.order.address!=null}}">
            实付款
            <text class="price">
                <text class="_rmb">￥</text>{{totalPrice}}
            </text>
        </block>
    </view>
    <view class="buy disable"  wx:if="{{props.order.address==null}}">请添加地址</view>
    <view class="buy" bind:tap="prePay" wx:if="{{props.order.address!=null}}">确认付款</view>
</view>